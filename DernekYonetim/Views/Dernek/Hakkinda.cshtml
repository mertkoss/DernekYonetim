@model DernekYonetim.Models.HomeViewModel
@{
    ViewData["Title"] = Model.About?.Baslik;
    Layout = "_Layout";
}

<section class="about-hero-section bg-primary-dark position-relative">
    <div class="container text-center position-relative z-index-2">

        <h1 class="about-page-title text-white mb-3">@Model.About?.Baslik</h1>

        <div class="about-page-meta">
            <i class="far fa-clock text-warning me-2"></i> Son güncelleme: @Model.About?.GuncellemeTarihi?.ToString("dd MMMM yyyy")
        </div>

        @if (Context.Session.GetInt32("AdminID") != null)
        {
            <div class="mt-4">
                <button class="btn btn-gold rounded-pill shadow-sm px-4 fw-bold" data-bs-toggle="modal" data-bs-target="#editAboutModal">
                    <i class="fas fa-edit me-2"></i>Sayfa İçeriğini Düzenle
                </button>
            </div>
        }
    </div>
</section>

<section class="about-content-section pb-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card border-0 shadow-lg content-card p-4 p-md-5 bg-white">
                    <div class="editorial-content">
                        @Html.Raw(Model.About?.Icerik)
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@if (Context.Session.GetInt32("AdminID") != null)
{
    <div class="modal fade" id="editAboutModal" tabindex="-1" aria-hidden="true" data-bs-focus="false">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg">
                <form action="/Dernek/BolumGuncelle" method="post">
                    <input type="hidden" name="Id" value="@Model.About?.Id" />
                    <input type="hidden" name="Slug" value="@Model.About?.Slug" />
                    <input type="hidden" name="Aktif" value="true" />

                    <div class="modal-header text-white border-0" style="background-color: #0a1a5c;">
                        <h5 class="modal-title fw-bold"><i class="fas fa-pen-nib text-warning me-2"></i>@Model.About?.Baslik - İçeriği Düzenle</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>

                    <div class="modal-body p-4 bg-light">
                        <div class="mb-4">
                            <label class="form-label fw-bold text-uppercase small text-muted">Sayfa Başlığı</label>
                            <input type="text" name="Baslik" class="form-control form-control-lg border-0 shadow-sm" value="@Model.About?.Baslik" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-bold text-uppercase small text-muted">İçerik Editörü</label>
                            <textarea name="Icerik" id="editor" class="form-control">@Model.About?.Icerik</textarea>
                        </div>
                    </div>

                    <div class="modal-footer border-0 bg-white">
                        <button type="button" class="btn btn-secondary rounded-pill px-4" data-bs-dismiss="modal">Vazgeç</button>
                        <button type="submit" class="btn btn-gold rounded-pill px-5 fw-bold text-dark">Değişiklikleri Uygula</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
}

<style>
    /* 1. RENKLER VE TEMEL STİLLER */
    :root {
        --renk-lacivert: #0a1a5c;
        --renk-altin: #ffc800; /* Anasayfayla uyumlu sarı/altın */
        --renk-text: #475569;
    }

    .bg-primary-dark {
        background-color: var(--renk-lacivert) !important;
    }

    .btn-gold {
        background-color: var(--renk-altin);
        border-color: var(--renk-altin);
        color: #000;
    }

        .btn-gold:hover {
            background-color: #e6b400;
            color: #000;
            transform: translateY(-2px);
        }

    /* 2. HERO (ÜST BİLGİ) BÖLÜMÜ */
    .about-hero-section {
        padding-top: 160px; /* Navbar'dan kurtarmak için */
        padding-bottom: 120px; /* Alttan boşluk bırakıyoruz ki kart üstüne binsin */
        background-image: radial-gradient(circle at top right, rgba(255, 200, 0, 0.05), transparent 40%);
    }

    .about-page-title {
        font-family: 'Playfair Display', serif;
        font-size: 3.5rem;
        font-weight: 800;
        letter-spacing: -1px;
    }

    .about-page-meta {
        display: inline-block;
        font-size: 0.95rem;
        color: rgba(255, 255, 255, 0.8);
        background: rgba(0, 0, 0, 0.2);
        padding: 8px 24px;
        border-radius: 50px;
        backdrop-filter: blur(5px);
    }

    /* 3. İÇERİK KARTI (OVERLAP EFEKTİ) */
    .about-content-section {
        margin-top: -80px; /* Kartı lacivert alanın üstüne doğru 80px çeker */
        position: relative;
        z-index: 10;
    }

    .content-card {
        border-radius: 16px;
        border-top: 6px solid var(--renk-altin) !important; /* Altın sarısı tepe çizgisi */
    }

    /* 4. EDİTORYAL İÇERİK (CKEDITOR ÇIKTISI) DÜZENLEMELERİ */
    /* Editörden gelen metinlerin sayfayı bozmaması için kurallar */
    .editorial-content {
        font-family: 'Inter', sans-serif;
        font-size: 1.15rem;
        line-height: 1.8;
        color: var(--renk-text);
    }

        .editorial-content p {
            margin-bottom: 1.5rem;
            text-align: justify;
        }

        .editorial-content img {
            max-width: 100% !important; /* Büyük resimlerin mobilde taşmasını engeller */
            height: auto !important;
            border-radius: 8px;
            margin: 1.5rem 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        /* Editörden gelen H2, H3, H4 Başlıkları */
        .editorial-content h1, .editorial-content h2, .editorial-content h3, .editorial-content h4 {
            font-family: 'Playfair Display', serif;
            color: var(--renk-lacivert);
            font-weight: 700;
            margin-top: 2.5rem;
            margin-bottom: 1.2rem;
        }

        .editorial-content h2 {
            font-size: 2.2rem;
            border-bottom: 2px solid rgba(10, 26, 92, 0.1);
            padding-bottom: 10px;
        }

        .editorial-content h3 {
            font-size: 1.8rem;
            border-left: 4px solid var(--renk-altin);
            padding-left: 15px;
        }

        /* Editör Listeleri */
        .editorial-content ul {
            list-style-type: none;
            padding-left: 0;
            margin-bottom: 2rem;
        }

            .editorial-content ul li {
                position: relative;
                padding-left: 30px;
                margin-bottom: 12px;
            }

                .editorial-content ul li::before {
                    content: '\f058'; /* FontAwesome Check Circle */
                    font-family: "Font Awesome 6 Free";
                    font-weight: 900;
                    color: var(--renk-altin);
                    position: absolute;
                    left: 0;
                    top: 2px;
                }

        /* Editör Tabloları */
        .editorial-content table {
            width: 100% !important;
            margin-bottom: 2rem;
            border-collapse: collapse;
        }

            .editorial-content table td, .editorial-content table th {
                padding: 12px;
                border: 1px solid #e2e8f0;
            }

    /* Mobil Uyum */
    @@media (max-width: 768px) {
        .about-hero-section

    {
        padding-top: 120px;
        padding-bottom: 80px;
    }

    .about-page-title {
        font-size: 2.2rem;
    }

    .about-content-section {
        margin-top: -40px;
    }

    .content-card {
        padding: 20px !important;
    }

    }
</style>

@section Scripts {
    <script src="https://cdn.ckeditor.com/4.22.1/standard/ckeditor.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {

            // Kartı aşağıdan yukarı zarifçe getiren Fade-in efekti
            const content = document.querySelector(".content-card");
            if (content) {
                content.style.opacity = 0;
                content.style.transform = "translateY(30px)";
                setTimeout(() => {
                    content.style.transition = "all 0.8s ease-out";
                    content.style.opacity = 1;
                    content.style.transform = "translateY(0)";
                }, 100);
            }

            // CKEditor'ü başlat ve Dosya Yükleme rotasını tanımla
            if (document.getElementById('editor')) {
                CKEDITOR.replace('editor', {
                    height: 400,
                    versionCheck: false,
                    uiColor: '#f8fafc',

                    // BİLGİSAYARDAN RESİM YÜKLEME AYARI
                    filebrowserUploadUrl: '/Dernek/ResimYukle',
                    filebrowserUploadMethod: 'xhr',

                    // --- YENİ EKLENEN PROFESYONEL RÖTUŞLAR ---

                    // 1. Alttaki kafa karıştıran "body p strong" HTML yol çubuğunu gizler
                    removePlugins: 'elementspath',

                    // 2. Resim penceresindeki sahte "Lorem Ipsum" yazısını ufak bir ikonla değiştirir
                    image_previewText: '🖼️ Görselinizin sayfadaki duruşu burada görünecektir.',

                    toolbarGroups: [
                        { name: 'document', groups: [ 'mode', 'document', 'doctools' ] },
                        { name: 'clipboard', groups: [ 'clipboard', 'undo' ] },
                        { name: 'basicstyles', groups: [ 'basicstyles', 'cleanup' ] },
                        { name: 'paragraph', groups: [ 'list', 'indent', 'blocks', 'align' ] },
                        { name: 'styles', groups: [ 'styles' ] },
                        { name: 'colors', groups: [ 'colors' ] },
                        { name: 'insert', groups: [ 'image', 'table', 'horizontalrule' ] }
                    ],
                    removeButtons: 'Subscript,Superscript'
                });
            }
        });
    </script>
}